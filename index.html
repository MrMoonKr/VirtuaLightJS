<!DOCTYPE html>

<html>

    <head>
        <script type="text/javascript" src="Utils/sylvester.js"></script>
        <script type="text/javascript" src="Utils/glUtils.js"></script>
        <script type="text/javascript" src="lightsource.js"></script>
        <script type="text/javascript" src="mesh.js"></script>
        <script type="text/javascript" src="models/model.js"></script>
        <script type="text/javascript" src="startup.js"></script>

        <script id="vs" type="x-shader/x-vertex">
            #version 300 es
            precision highp float;
            precision highp int;

            layout(std140, column_major) uniform;

            struct Transform
            {
                mat4 uPMatrix;
                mat4 uMVMatrix;
                mat4 uNormalMatrix;
            };

            uniform PerDraw
            {
                Transform transform;
            } u_perDraw;

            layout(location = 0) in vec3 position;
            layout(location = 1) in vec3 normal;
            layout(location = 2) in vec4 color;

            out highp vec4 vColor;
            out highp vec4 vNormal;

            void main(void) {
                gl_Position = u_perDraw.transform.uPMatrix * u_perDraw.transform.uMVMatrix * vec4(position, 1.0);
                vColor = color;
                vNormal = u_perDraw.transform.uNormalMatrix * vec4(normal, 1.0);
            }
        </script>

        <script id="fs" type="x-shader/x-fragment">
            #version 300 es
            precision highp float;
            precision highp int;


            #define M_PI 3.1415926535897932384626433832795
            #define MAX_LIGHTS 5

            layout(std140, column_major) uniform;

            struct LightSource
            {
                vec4 position;
                vec4 color;
                float intensity;
                // Attenuation:
                float aconst;
                float alin;
                float aquad;
            };

            struct Mesh{
                float diffuse;
                float specular;
                float shininess;
                float roughness;
                float fresnel;
            };

            uniform PerScene
            {
                Mesh mesh;
            } u_perScene;

            uniform PerPass
            {
                LightSource lights;
            } u_perPass;

            in highp vec4 vColor;
            in highp vec4 vNormal;

            out vec4 color;

            void main(void) {
                color = vColor;
            }

        </script>

        <script src="main_loop.js"></script>
        <script src="matrix_utility.js"></script>
    </head>
    
    <body onload="start()">
        <!-- Editing the width and height attributes of a canvas element after the context has been created will also not change the number of pixels to be drawn.
        To change the resolution which WebGL renders at, such as when the user resizes the window of a full-document canvas or you wish to provide in-app adjustable graphics settings, you will need to call the WebGL context's viewport() function to acknowledge the change.
        gl.viewport(0, 0, canvas.width, canvas.height);
        -->
        <canvas id="glCanvas" width="640" height="480">
            Your browser doesn't appear to support the 
            <code>&lt;canvas&gt;</code> element.
         </canvas>
    </body>

</html>